from typing import List

import feedparser
import websites
from datetime import datetime


def get_url_list(current_time: datetime) -> List:
    """
        Iterates through all articles returned by the feedparser and saves only
        the articles published today.
        Args:
            current day
        Returns:
            List containg articles' url published on the current day
    """
    url_list = []

    securityaffairs_url = websites.SECURITYAFFAIRS
    feed = feedparser.parse(securityaffairs_url)

    if 'entries' in feed.keys():
        for entry in feed['entries']:
            # date format example : Thu, 1 Oct 2020 01:07:00 +0000
            # removing first and last characters
            time_str = entry['published'][5:][:-6]
            # mapping publishing time to datetime format
            time_object = datetime.strptime(time_str, '%d %b %Y %H:%M:%S')
            if time_object.day == current_time.day:
                url_list.append(entry['link'])

    return url_list
